#!/bin/bash
source_dir=$(cd -- "$(dirname -- "$0")" && pwd)
. "$source_dir/../qquser-check"

# Check if URL argument exists
if [ $# -ne 2 ]; then
	echo "Invalid number of arguments (ex: qqyt-dlp -audio|-video \"URL\")"
	exit 1
fi

mkdir "$HOME"/Downloads/yt-dlp
cd "$HOME"/Downloads/yt-dlp

case "$1" in
	-audio)
		# Best audio quality
		yt-dlp --cookies-from-browser firefox:"$HOME"/.librewolf --extract-audio --audio-format mp3 --audio-quality 0 --no-playlist "$2"
		;;
	-video)
		# Best video quality
		yt-dlp --cookies-from-browser firefox:"$HOME"/.librewolf --format "bestvideo[height<=1080]+bestaudio" --no-playlist "$2"
		;;
	*)
		echo "Invalid argument (-audio, video)"
		exit 1
		;;
esac

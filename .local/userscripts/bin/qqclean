#!/bin/bash
set -eo pipefail
source_dir=$(cd -- "$(dirname -- "$0")" && pwd)
. "$source_dir/../qquser-check"

if [[ "$1" = "wine" ]]; then
	rm -rf "$HOME/.wine"
	rm -rf "$HOME/.local/share/applications/wine"
	sudo "$source_dir/../qqsudo" rm -rf "/root/.wine"
fi

echo "Running bleachbit"
bleachbit -c --preset &> /dev/null
echo "Running bleachbit root"
sudo "$source_dir/../qqsudo" bleachbit -c --preset &> /dev/null

# nfs trash
rm -rf "/mnt/nfs1/.Trash-1000"
rm -rf "/mnt/nfs2/.Trash-1000"

# bash
rm -f "$HOME/.bash_history"
sudo "$source_dir/../qqsudo" rm -f "/root/.bash_history"
# vim
rm -f "$HOME/.vim/viminfo"
rm -f "$HOME/.vim/.netrwhist"
rm -f "$HOME/.vim/swap/"*
# vifm
rm -f "$HOME/.config/vifm/vifminfo.json"
# iwctl
rm -f "$HOME/.config/iwctl/history"
# other home directory
rm -f "$HOME/.lesshst"
sudo "$source_dir/../qqsudo" rm -f "/root/.lesshst"
rm -f "$HOME/.wget-hsts"
sudo "$source_dir/../qqsudo" rm -f "/root/.wget-hsts"
# ssh
rm -f "$HOME/.ssh/known_hosts"*
# X session errors
rm -f "$HOME/.xsession-errors"
# zathura
rm -f "$HOME/.local/share/zathura/"*
# cache
rm -rf "$HOME/.cache"
sudo "$source_dir/../qqsudo" rm -rf "/root/.cache"
# GIMP recent files (and others)
rm -f "$HOME/.local/share/recently-used.xbel"
# MPV saved video locations
rm -f "$HOME/.config/mpv/watch_later/"*
# Extra clutter
rm -rf "$HOME/.pki"
rm -f "$HOME/.sudo_as_admin_successful"
sudo "$source_dir/../qqsudo" rm -f "/root/.sudo_as_admin_successful"
rm -rf "$HOME/.config/menus"
rm -rf "$HOME/.config/dconf"
rm -rf "$HOME/.config/xresources.d"
rm -rf "$HOME/.config/QtProject.conf"
rm -rf "$HOME/.local/share/desktop-directories"
rm -rf "$HOME/.local/share/mime"
rm -rf "$HOME/.local/share/icons/hicolor"
rm -rf "$HOME/.local/share/gegl-0.4"
rm -rf "$HOME/.local/share/xorg"
rm -rf "$HOME/.local/share/recently-used.xbel"
# Audacity recent files
sed -i '/^file/d' "$HOME/.config/audacity/audacity.cfg" || true
# OpenOffice recent files
sed -i "/^<item oor:path=\"\/org.openoffice.Office.Histories/d" "$HOME/.config/libreoffice/4/user/registrymodifications.xcu" || true
# Soulseek downloads and chats
# rm -rf "$HOME/.soulseek/Soulseek Downloads"/*
# rm -rf "$HOME/.soulseek/Soulseek Chat Logs"/*

echo "Done cleaning"

" vim: filetype=vim :

" ---------------------------
" BASIC FUNCTIONALITY
" ---------------------------
" use xdg defaults for all files:
filetype * xdg-open 2>/dev/null &
" enable mouse (requires version 0.13)
" set mouse=a
" uses vifm utilities instead of shell utilities
set syscalls
" show hidden files
set dotfiles
" set trash and trashdir
set trash trashdir="$HOME/.local/share/Trash/files"
" what should be saved automatically between vifm session
set vifminfo=chistory,shistory,phistory,fhistory,registers,bookmarks,bmarks
" history max
set history=1000
" maximum number of changes that can be undone
set undolevels=1000
" automatically resolve symbolic links
set nofollowlinks
" do not run executables
set norunexec
" natural sort of (version) numbers within text
set sortnumbers
" use vim's format for help file
set vimhelp
" case-insensitive search unless using upper case letters
set ignorecase smartcase
" search as you type and highlight matches
set incsearch hlsearch
" number of lines to keep  at top or bottom while scrolling
set scrolloff=8
" don't do too many requests to slow file systems
set slowfs=curlftpfs
" case insensitive :find command
set findprg="find %s -iname %p"
" case insensitive :grep command
set grepprg="grep -irnHI %i %a %s"
" TODO: use bash login shell (not sourcing bashrc with sudo or root)
set shell=/bin/bash shellcmdflag=-lc
" set $PATH to system $PATH when sudo or root
let $PATH = system('echo $PATH')

" ---------------------------
" STATUS LINE
" ---------------------------
" begin statusline
set statusline=
" display if root or sudo
if $HOME == '/root' || $USER == 'root'
	if $HOME == '/root'
		set statusline+=(root)\ 
	else
		set statusline+=(sudo)\ 
	endif
endif
" display if ssh connection
if $SSH_CONNECTION != ''
	set statusline+=(ssh)\ 
endif
" finish statusline
set statusline+=%A\ %u:%g\ %E\ %T%=%d

" ---------------------------
" VISUAL TWEAKS
" ---------------------------
" show directory preview by default
view!
" no wrapping in previews
set nowrap
" show only filenames in view columns
windo set viewcolumns=-{name}..
" time format. See man date or man strftime
set timefmt=%b\ %d\ %I:%M%P\ %Y

" ---------------------------
" COLORSCHEME
" ---------------------------
" colorscheme
colorscheme gruvbox
" turn off backgrounds (for terminal transparency)
hi Win guibg=NONE ctermbg=NONE
hi Border guibg=NONE ctermbg=NONE
hi CmdLine guibg=NONE ctermbg=NONE

" ---------------------------
" AUTO-COMPLETE (COMMAND LINE)
" ---------------------------
" turn on completions in command line
set wildmenu
" display pop up menu
set wildstyle=popup
" Display suggestions in the following modes
set suggestoptions=normal,visual,view,otherpane,keys,marks,registers
" case insensitive completions
set caseoptions=p

" ---------------------------
" MARKS
" ---------------------------
mark h ~
mark H /mnt/ext1/backups/disk/home/qq

mark r /root
mark R /mnt/ext1/backups/disk/root

mark g /home/qq/Games
mark G /mnt/ext1/backups/disk/home/qq/Games

mark c ~/.config
mark C /mnt/ext1/backups/disk/home/qq/.config

mark s ~/.local/share
mark S /mnt/ext1/backups/disk/home/qq/.local/share

mark t ~/.local/share/Trash/files

mark d /mnt/nfs/dev
mark D /mnt/ext1/backups/nfs/dev

mark w /home/qq/Downloads
mark W /mnt/ext1/backups/disk/home/qq/Downloads

mark u /mnt/nfs/documents
mark U /mnt/ext1/backups/nfs/documents

mark v /mnt/nfs/videos
mark V /mnt/ext1/backups/nfs/videos

mark p /mnt/nfs/pictures
mark P /mnt/ext1/backups/nfs/pictures

mark m /mnt/nfs/music
mark M /mnt/ext1/backups/nfs/music

nnoremap '[ :cd /mnt/ext1<CR>
nnoremap '] :cd /mnt/ext2<CR>
nnoremap '\ :cd /mnt/nfs<CR>

nnoremap 'n :cd /mnt/nfs/notes<CR>
nnoremap 'N :cd /mnt/part/journal<CR>

" ---------------------------
" KEYMAPS
" ---------------------------
" set keymap timeout delay
set timeoutlen=2000

" set name change keymaps
noremap cw cW
noremap cW cw
noremap cc cW<c-u>

" remove space keymapping
noremap <Space> <nop>
noremap <Space><Space> <nop>

" 1 -> 9
nnoremap <Space><BS> :source $HOME/.config/vifm/vifmrc<CR>

" q -> p
nnoremap <Space>q :q<CR>
nnoremap <Space>Q :q!<CR>
nnoremap <Space>e :!nohup alacritty --config-file $HOME/.config/alacritty/vim.yml --class vim -e vim %d > /dev/null 2>&1 &<CR>
nnoremap <Space>t :!nohup alacritty --config-file $HOME/.config/alacritty/term.yml --working-directory %d > /dev/null 2>&1 &<CR>
nnoremap <Space>y :history<CR>
nnoremap <Space>i :help<Space>

" a -> l
nnoremap <Space>s :sort<CR>
nnoremap <C-h> :tabprevious<CR>
nnoremap <C-l> :tabnext<CR>
nnoremap <Space>; :!
nnoremap <Space>: :sh<CR>
nnoremap <Space>' :marks<CR>
nnoremap <Space>" :registers<CR>

" z -> m
nnoremap <Space>x :tabc<CR>
nnoremap <Space>n :find **<Left>
nnoremap <Space>m :tabnew<Space>
nnoremap <Space>, :norm<Space>
nnoremap <Space>. :%s///g<Left><Left><Left>
vnoremap <Space>. :s///g<Left><Left><Left>
nnoremap <Space>/ :grep<Space>
